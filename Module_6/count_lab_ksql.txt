1. Run the commands inside KSQL

CREATE STREAM NUMBERS2 (num INT) WITH (KAFKA_TOPIC='numbers2', PARTITIONS=1, VALUE_FORMAT='JSON');


2. Insert some values

INSERT INTO NUMBERS2 (num) VALUES (1);
INSERT INTO NUMBERS2 (num) VALUES (2);
INSERT INTO NUMBERS2 (num) VALUES (1);
INSERT INTO NUMBERS2 (num) VALUES (0);
INSERT INTO NUMBERS2 (num) VALUES (2);
INSERT INTO NUMBERS2 (num) VALUES (2);



3. SET 'auto.offset.reset' = 'earliest';


4. 

SELECT num, COUNT(num) AS cat FROM NUMBERS2 GROUP BY num EMIT CHANGES;